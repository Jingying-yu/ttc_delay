---
title: "Choosing TTC x Provides the Most Time Stability during Rush Hours"
subtitle: "Analysis on the Delay Magnitude of different TTC Services"
author: 
  - Sandy Yu
thanks: "Code and data are available at: https://github.com/Jingying-yu/central_intake_calls_and_homeless_death_count.git"
date: today
date-format: long
abstract: "For the City of Toronto, the physical well-being of its local homeless population has always been one of its primary focuses. Numerous social efforts, funded by the City, were made in attempts to reduce the death rate of the local homeless population. In order to visualize the magnitude of social impact enforced by the City of Toronto, analyses were performed to investigate the correlation between the efforts made by the staff of Torontoâ€™s Central Intake Line and the monthly homeless death counts between November 2020 to June 2023 using data from OpenDataToronto. Staff efforts such as the number of calls coded, number of referral to shelter, and number of information for homelessness prevention, were documented and compared against the monthly homeless death counts. An inverse correlation is found between the number of calls coded and the homeless death count. No discernible correlations were found between coded call types of interest and the monthly homeless death counts."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(dplyr)
library(lubridate)
library(zoo)
library(knitr)
library(ggplot2)
```


# Introduction





# Data {#sec-data}




## TTC Bus Delay



```{r}
#| label: tbl-monthly-calls
#| tbl-cap: Sample of Cleaned Central Intake Call Wrap-up Codes Dataset
#| echo: false

central_intake_call <- read.csv(here::here("outputs/data/cleaned_central_intake_call.csv"))

sample_central_intake_call <- head(central_intake_call)

knitr::kable(sample_central_intake_call, col.names = c("Month", "Calls Coded", "Referral to Shelter", "Homelessness Prevention Info"), align = c("l", "c", "c", "c"))
```


## TTC Streetcar Delay


```{r}
#| label: tbl-death-count
#| tbl-cap: Sample of Cleaned Deaths of People Experiencing Homelessness Dataset
#| echo: false

homeless_death_counts <- read.csv(here::here("outputs/data/cleaned_homeless_death_counts.csv"))

sample_homeless_death_counts <- head(homeless_death_counts, n = 3)

knitr::kable(sample_homeless_death_counts, col.names = c("Last Day of Month", "Death Count"), align = c("c", "c"))
```


## TTC Subway Delay

```{r}
#| label: tbl-combined
#| tbl-cap: Sample of Combined dataset
#| echo: false

combined_data <- read_csv(here::here("outputs/data/combined_data.csv"),
                          show_col_types = FALSE)

sample_combined_data <- head(combined_data, n = 3)

knitr::kable(sample_combined_data, col.names = c("Month", "Calls Coded", "Referral to Shelter", "Homelessness Prevention Info", "Death Count"), align = c("l","c", "c", "c","c"))
```

## TTC Delay Comparision



# Results {#sec-result}



## Highest Number of Total Delayed

```{r}
#| label: fig-coded
#| fig-cap: Visualization to show correlation between number of Calls Coded (represented by the red line) and Homeless Death Counts (represented by the blue line)
#| echo: false
#| message: false

combined_data <- read_csv(here::here("outputs/data/combined_data.csv"),
                          show_col_types = FALSE)


combined_data|> ggplot(mapping = aes(x = Month, y = Death_Count)) + 
  geom_point() + geom_smooth() + 
  geom_line(aes(x = Month, y = Calls_Coded_month/1000), color = "red") +
  labs(
    title = "Calls Coded & Homeless Death Count",
    x = "Time (in Month)",
    y = "Count"
  )
#still need to add a legend or label, but I haven't yep figured out how
```

## Most Delayed during Weekday
Define Rush Hours

Present Results During Rush Hours & at Off-Peak Hours
```{r}
#| label: fig-referred
#| fig-cap: Visualization to show correlation between number of callers referred to shelter (represented by the purple line) and Homeless Death Counts (represented by the blue line)
#| echo: false
#| message: false

combined_data <- read_csv(here::here("outputs/data/combined_data.csv"),
                          show_col_types = FALSE)


combined_data|> ggplot(mapping = aes(x = Month, y = Death_Count)) + 
  geom_point() + geom_smooth() + 
  geom_line(aes(x = Month, y = Referral_to_Shelter_month/100), color = "purple") +
  labs(
    title = "Callers Referred to Shelter & Homeless Death",
    x = "Time (in Month)",
    y = "Count"
  )
#still need to add a legend or label, but I haven't yep figured out how
```



## Most Delayed during Weekends

```{r}
#| label: fig-informed
#| fig-cap: Visualization to show correlation between number of callers given information on homelessness prevention (represented by the dark green line) and Homeless Death Counts (represented by the blue line)
#| echo: false
#| message: false

combined_data <- read_csv(here::here("outputs/data/combined_data.csv"),
                          show_col_types = FALSE)


combined_data|> ggplot(mapping = aes(x = Month, y = Death_Count)) + 
  geom_point() + geom_smooth() + 
  geom_line(aes(x = Month, y = Information_Homelessness_and_Prevention_month/100), color = "darkgreen") +
  labs(
    title = "Callers given Info on Homeless Prevention vs Homeless Death",
    x = "Time (in Month)",
    y = "Count"
  )
#still need to add a legend or label, but I haven't yep figured out how
```

## Most Popular Delay Reasons
- 1 table for all three services

## Most Popular Delayed Vehicles
- 1 table for all three services



# Discussion {#sec-discussion}

## TTC Service Prices {#sec-price}
- one-fare

## Correlation between Delay and Direction of Travel
- Financial District
- Midtown Direction

## TTC Service Amenities
- The PATH (for financial district)
- AC in Summer & Winter

## Errors in analysis, Limitations and Next Steps





# Conclusion {#sec-conclusion}






\newpage


# References


